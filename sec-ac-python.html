<!DOCTYPE html>
<!--********************************************-->
<!--*       Generated from PreTeXt source      *-->
<!--*                                          *-->
<!--*         https://pretextbook.org          *-->
<!--*                                          *-->
<!--********************************************-->
<html lang="en-US" dir="ltr">
<head xmlns:og="http://ogp.me/ns#" xmlns:book="https://ogp.me/ns/book#">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Using Python in AC circuits</title>
<meta name="Keywords" content="Authored in PreTeXt">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta property="og:type" content="book">
<meta property="book:title" content="Electronics">
<meta property="book:author" content="Derek J. Thuecks">
<script src="https://sagecell.sagemath.org/static/embedded_sagecell.js"></script><script>
var runestoneMathReady = new Promise((resolve) => window.rsMathReady = resolve);
window.MathJax = {
  "tex": {
    "inlineMath": [
      [
        "\\(",
        "\\)"
      ]
    ],
    "tags": "none",
    "tagSide": "right",
    "tagIndent": ".8em",
    "packages": {
      "[+]": [
        "base",
        "extpfeil",
        "ams",
        "amscd",
        "color",
        "newcommand",
        "knowl"
      ]
    }
  },
  "options": {
    "ignoreHtmlClass": "tex2jax_ignore|ignore-math",
    "processHtmlClass": "process-math",
    "renderActions": {
      "findScript": [
        10,
        function (doc) {
            document.querySelectorAll('script[type^="math/tex"]').forEach(function(node) {
                var display = !!node.type.match(/; *mode=display/);
                var math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
                var text = document.createTextNode('');
                node.parentNode.replaceChild(text, node);
                math.start = {node: text, delim: '', n: 0};
                math.end = {node: text, delim: '', n: 0};
                doc.math.push(math);
            });
        },
        ""
      ]
    }
  },
  "chtml": {
    "scale": 0.98,
    "mtextInheritFont": true
  },
  "loader": {
    "load": [
      "input/asciimath",
      "[tex]/extpfeil",
      "[tex]/amscd",
      "[tex]/color",
      "[tex]/newcommand",
      "[pretext]/mathjaxknowl3.js"
    ],
    "paths": {
      "pretext": "_static/pretext/js/lib"
    }
  },
  "startup": {
    pageReady() {
      return MathJax.startup.defaultPageReady().then(function () {
      console.log("in ready function");
      rsMathReady();
      }
    )}
  }
};
</script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script><script>// Make *any* div with class 'sagecell-python' an executable Sage cell
// Their results will be linked, only within language type
sagecell.makeSagecell({
  "inputLocation": "div.sagecell-python",
  "linked": true,
  "linkKey": "linked-python",
  "autoeval": false,
  "languages": [
    "python"
  ],
  "evalButtonText": "Evaluate (Python)"
});
</script><script src="https://cdnjs.cloudflare.com/ajax/libs/lunr.js/2.3.9/lunr.min.js" integrity="sha512-4xUl/d6D6THrAnXAwGajXkoWaeMNwEKK4iNfq5DotEbLPAfk6FSxSP3ydNxqDgCw1c/0Z1Jg6L8h2j+++9BZmg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><script src="lunr-pretext-search-index.js" async=""></script><script src="_static/pretext/js/pretext_search.js"></script><script src="_static/pretext/js/lib/jquery.min.js"></script><script src="_static/pretext/js/lib/jquery.sticky.js"></script><script src="_static/pretext/js/lib/jquery.espy.min.js"></script><script src="_static/pretext/js/pretext.js"></script><script src="_static/pretext/js/pretext_add_on.js?x=1"></script><script src="_static/pretext/js/user_preferences.js"></script><script src="_static/pretext/js/lib/knowl.js"></script><!--knowl.js code controls Sage Cells within knowls--><script>sagecellEvalName='Evaluate (Sage)';
</script><link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0">
<link href="_static/pretext/css/theme.css" rel="stylesheet" type="text/css">
<!--** eBookCongig is necessary to configure interactive       **-->
<!--** Runestone components to run locally in reader's browser **-->
<!--** No external communication:                              **-->
<!--**     log level is 0, Runestone Services are disabled     **-->
<script type="text/javascript">
eBookConfig = {};
eBookConfig.useRunestoneServices = false;
eBookConfig.host = 'http://127.0.0.1:8000';
eBookConfig.course = 'PTX_Course_Title_Here';
eBookConfig.basecourse = 'PTX_Base_Course';
eBookConfig.isLoggedIn = false;
eBookConfig.email = '';
eBookConfig.isInstructor = false;
eBookConfig.logLevel = 0;
eBookConfig.username = '';
eBookConfig.readings = null;
eBookConfig.activities = null;
eBookConfig.downloadsEnabled = false;
eBookConfig.allow_pairs = false;
eBookConfig.enableScratchAC = false;
eBookConfig.build_info = "";
eBookConfig.python3 = null;
eBookConfig.runestone_version = '7.5.1';
eBookConfig.jobehost = '';
eBookConfig.proxyuri_runs = '';
eBookConfig.proxyuri_files = '';
eBookConfig.enable_chatcodes =  false;
</script>
<!--*** Runestone Services ***-->
<script src="_static/prefix-runtime.87cabc2515250052.bundle.js"></script><script src="_static/prefix-723.3e6434f80549315a.bundle.js"></script><script src="_static/prefix-runestone.630d5c4fb4b681eb.bundle.js"></script><link rel="stylesheet" type="text/css" href="_static/prefix-723.3bccd435914aa0ff.css">
<link rel="stylesheet" type="text/css" href="_static/prefix-runestone.97f3ae4f7a71ba18.css">
<style>
#subsec-dc-analysis-branch-2-2 { counter-set: subsec-dc-analysis-branch-2-2 0; }
#subsec-dc-analysis-branch-2-2 > li::marker { content: ""counter(subsec-dc-analysis-branch-2-2,decimal)"."; }
#subsec-dc-analysis-branch-2-2 > li { counter-increment: subsec-dc-analysis-branch-2-2; }
#subsec-dc-analysis-mesh-2-2 { counter-set: subsec-dc-analysis-mesh-2-2 0; }
#subsec-dc-analysis-mesh-2-2 > li::marker { content: ""counter(subsec-dc-analysis-mesh-2-2,decimal)"."; }
#subsec-dc-analysis-mesh-2-2 > li { counter-increment: subsec-dc-analysis-mesh-2-2; }
#subsec-dc-analysis-gaussian-2-3 { counter-set: subsec-dc-analysis-gaussian-2-3 0; }
#subsec-dc-analysis-gaussian-2-3 > li::marker { content: ""counter(subsec-dc-analysis-gaussian-2-3,decimal)"."; }
#subsec-dc-analysis-gaussian-2-3 > li { counter-increment: subsec-dc-analysis-gaussian-2-3; }
#subsec-finding-thevenin-2-1 { counter-set: subsec-finding-thevenin-2-1 0; }
#subsec-finding-thevenin-2-1 > li::marker { content: ""counter(subsec-finding-thevenin-2-1,decimal)"."; }
#subsec-finding-thevenin-2-1 > li { counter-increment: subsec-finding-thevenin-2-1; }
#subsec-finding-thevenin-3-1 { counter-set: subsec-finding-thevenin-3-1 0; }
#subsec-finding-thevenin-3-1 > li::marker { content: ""counter(subsec-finding-thevenin-3-1,decimal)"."; }
#subsec-finding-thevenin-3-1 > li { counter-increment: subsec-finding-thevenin-3-1; }
#sec-ac-amplitudes-2-1-1 { counter-set: sec-ac-amplitudes-2-1-1 0; }
#sec-ac-amplitudes-2-1-1 > li::marker { content: ""counter(sec-ac-amplitudes-2-1-1,decimal)"."; }
#sec-ac-amplitudes-2-1-1 > li { counter-increment: sec-ac-amplitudes-2-1-1; }
#sec-ac-highpass-4-24 { counter-set: sec-ac-highpass-4-24 0; }
#sec-ac-highpass-4-24 > li::marker { content: ""counter(sec-ac-highpass-4-24,decimal)"."; }
#sec-ac-highpass-4-24 > li { counter-increment: sec-ac-highpass-4-24; }
#sec-ac-phasors-6-4 { counter-set: sec-ac-phasors-6-4 0; }
#sec-ac-phasors-6-4 > li::marker { content: ""counter(sec-ac-phasors-6-4,decimal)"."; }
#sec-ac-phasors-6-4 > li { counter-increment: sec-ac-phasors-6-4; }
#sec-ac-phasors-9-4-3-1 { counter-set: sec-ac-phasors-9-4-3-1 0; }
#sec-ac-phasors-9-4-3-1 > li::marker { content: ""counter(sec-ac-phasors-9-4-3-1,decimal)"."; }
#sec-ac-phasors-9-4-3-1 > li { counter-increment: sec-ac-phasors-9-4-3-1; }
#sec-ac-phasors-10-4-2-1 { counter-set: sec-ac-phasors-10-4-2-1 0; }
#sec-ac-phasors-10-4-2-1 > li::marker { content: ""counter(sec-ac-phasors-10-4-2-1,decimal)"."; }
#sec-ac-phasors-10-4-2-1 > li { counter-increment: sec-ac-phasors-10-4-2-1; }
#sec-diode-circuit-analytic-3-1 { counter-set: sec-diode-circuit-analytic-3-1 0; }
#sec-diode-circuit-analytic-3-1 > li::marker { content: ""counter(sec-diode-circuit-analytic-3-1,decimal)"."; }
#sec-diode-circuit-analytic-3-1 > li { counter-increment: sec-diode-circuit-analytic-3-1; }
</style>
</head>
<body id="electronics.thuecks" class="pretext book ignore-math">
<a class="assistive" href="#ptx-content">Skip to main content</a><header id="ptx-masthead" class="ptx-masthead"><div class="ptx-banner">
<a id="logo-link" class="logo-link" target="_blank" href=""></a><div class="title-container">
<h1 class="heading"><a href="Electronics.html"><span class="title">Electronics:</span> <span class="subtitle">Theory and Practice</span></a></h1>
<p class="byline">Derek J. Thuecks</p>
</div>
</div></header><nav id="ptx-navbar" class="ptx-navbar navbar"><div class="ptx-navbar-contents">
<button class="toc-toggle button" title="Contents"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5d2;</span><span class="name">Contents</span></button><div class="searchbox">
<div class="searchwidget"><button id="searchbutton" class="searchbutton button" type="button" title="Search book"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe8b6;</span><span class="name">Search Book</span></button></div>
<div id="searchresultsplaceholder" class="searchresultsplaceholder" style="display: none">
<div class="search-results-controls">
<input aria-label="Search term" id="ptxsearch" class="ptxsearch" type="text" name="terms" placeholder="Search term"><button title="Close search" id="closesearchresults" class="closesearchresults"><span class="material-symbols-outlined">close</span></button>
</div>
<h2 class="search-results-heading">Search Results: </h2>
<div id="searchempty" class="searchempty"><span>No results.</span></div>
<ol id="searchresults" class="searchresults"></ol>
</div>
</div>
<span class="nav-other-controls"><button id="light-dark-button" class="light-dark-button button" title="Dark Mode"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe51c;</span><span class="name">Dark Mode</span></button></span><span class="treebuttons"><a class="previous-button button" href="sec-ac-phasors.html" title="Previous"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5cb;</span><span class="name">Prev</span></a><a class="up-button button" href="ch-ac.html" title="Up"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5ce;</span><span class="name">Up</span></a><a class="next-button button" href="sec-ac-thevenin.html" title="Next"><span class="name">Next</span><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5cc;</span></a></span>
</div></nav><div id="latex-macros" class="hidden-content process-math" style="display:none"><span class="process-math">\(\newcommand{\vect}[1]{\mathbf{#1}}
\newcommand{\lt}{&lt;}
\newcommand{\gt}{&gt;}
\newcommand{\amp}{&amp;}
\definecolor{fillinmathshade}{gray}{0.9}
\newcommand{\fillinmath}[1]{\mathchoice{\colorbox{fillinmathshade}{$\displaystyle     \phantom{\,#1\,}$}}{\colorbox{fillinmathshade}{$\textstyle        \phantom{\,#1\,}$}}{\colorbox{fillinmathshade}{$\scriptstyle      \phantom{\,#1\,}$}}{\colorbox{fillinmathshade}{$\scriptscriptstyle\phantom{\,#1\,}$}}}
\)</span></div>
<div class="ptx-page">
<div id="ptx-sidebar" class="ptx-sidebar"><nav id="ptx-toc" class="ptx-toc depth2 focused" data-preexpanded-levels="0" data-max-levels="2"><ul class="structural toc-item-list contains-active">
<li class="toc-item toc-frontmatter"><div class="toc-title-box"><a href="frontmatter.html" class="internal"><span class="title">Front Matter</span></a></div></li>
<li class="toc-item toc-chapter">
<div class="toc-title-box"><a href="ch-introduction.html" class="internal"><span class="codenumber">1</span> <span class="title">Introduction</span></a></div>
<ul class="structural toc-item-list"><li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-introduction-review.html" class="internal"><span class="codenumber">1.1</span> <span class="title">Review from Introductory Physics</span></a></div></li></ul>
</li>
<li class="toc-item toc-chapter">
<div class="toc-title-box"><a href="ch-dc.html" class="internal"><span class="codenumber">2</span> <span class="title">DC Circuits</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-dc-kirchhoff.html" class="internal"><span class="codenumber">2.1</span> <span class="title">Kirchhoff’s Laws</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-dc-voltage-source-symbol.html" class="internal"><span class="codenumber">2.2</span> <span class="title">Voltage Source Symbols</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-dc-series_parallel.html" class="internal"><span class="codenumber">2.3</span> <span class="title">Series and Parallel Resistors</span></a></div></li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-dc-analysis.html" class="internal"><span class="codenumber">2.4</span> <span class="title">Circuit Analysis Methods</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-dc-analysis.html#subsec-dc-analysis-reduction" class="internal"><span class="codenumber">2.4.1</span> <span class="title">Analysis: Circuit Reduction</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-dc-analysis.html#subsec-dc-analysis-branch" class="internal"><span class="codenumber">2.4.2</span> <span class="title">Analysis: Branch Method</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-dc-analysis.html#subsec-dc-analysis-mesh" class="internal"><span class="codenumber">2.4.3</span> <span class="title">Analysis: Mesh Method</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-dc-analysis.html#subsec-dc-analysis-scipy" class="internal"><span class="codenumber">2.4.4</span> <span class="title">Analysis: Branch Method Solved Using SciPy</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-dc-analysis.html#subsec-dc-analysis-sympy" class="internal"><span class="codenumber">2.4.5</span> <span class="title">Analysis: Branch Method Solved Using SymPy</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-dc-analysis.html#subsec-dc-analysis-gaussian" class="internal"><span class="codenumber">2.4.6</span> <span class="title">Analysis: Branch Method Solved Using Gaussian Elimination</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-dc-superposition.html" class="internal"><span class="codenumber">2.5</span> <span class="title">Superposition Theorem</span></a></div></li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-dc-thevenin.html" class="internal"><span class="codenumber">2.6</span> <span class="title">Thevenin and Norton Theorem</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-dc-thevenin.html#subsec-proof-thevenin" class="internal"><span class="codenumber">2.6.1</span> <span class="title">Proof of Thevenin’s and Norton’s Theorems</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-dc-thevenin.html#subsec-finding-thevenin" class="internal"><span class="codenumber">2.6.2</span> <span class="title">Finding Thevenin Equivalent Circuits</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-dc-batteries.html" class="internal"><span class="codenumber">2.7</span> <span class="title">Application of Thevenin Equivalent Cicruits: Batteries</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-dc-uses.html" class="internal"><span class="codenumber">2.8</span> <span class="title">DC Circuit Uses</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-chapter contains-active">
<div class="toc-title-box"><a href="ch-ac.html" class="internal"><span class="codenumber">3</span> <span class="title">AC Circuits</span></a></div>
<ul class="structural toc-item-list contains-active">
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-ac-sinusoidal.html" class="internal"><span class="codenumber">3.1</span> <span class="title">Sinusoidal Signals</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-ac-amplitudes.html" class="internal"><span class="codenumber">3.2</span> <span class="title">Characterizing Signal Size</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-ac-complexsigs.html" class="internal"><span class="codenumber">3.3</span> <span class="title">Complex Signals</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-ac-complexZ.html" class="internal"><span class="codenumber">3.4</span> <span class="title">Complex Impedance</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-ac-capcharging.html" class="internal"><span class="codenumber">3.5</span> <span class="title">Capacitor Charging and Discharging Behaviors</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-ac-highpass.html" class="internal"><span class="codenumber">3.6</span> <span class="title">RC High-pass filter</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-ac-phasors.html" class="internal"><span class="codenumber">3.7</span> <span class="title">Phasors</span></a></div></li>
<li class="toc-item toc-section active"><div class="toc-title-box"><a href="sec-ac-python.html" class="internal"><span class="codenumber">3.8</span> <span class="title">Using Python in AC circuits</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-ac-thevenin.html" class="internal"><span class="codenumber">3.9</span> <span class="title">Input and Output Impedance</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-chapter">
<div class="toc-title-box"><a href="ch-diode.html" class="internal"><span class="codenumber">4</span> <span class="title">Diodes</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-diode-semiconductors.html" class="internal"><span class="codenumber">4.1</span> <span class="title">Semiconductors</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-diode-behavior.html" class="internal"><span class="codenumber">4.2</span> <span class="title">Diode behavior</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-diode-types.html" class="internal"><span class="codenumber">4.3</span> <span class="title">Diode Types</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-diode-circuit-analytic.html" class="internal"><span class="codenumber">4.4</span> <span class="title">Analysis of diode circuits</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-backmatter"><div class="toc-title-box"><a href="backmatter.html" class="internal"><span class="title">Backmatter</span></a></div></li>
</ul></nav></div>
<main class="ptx-main"><div id="ptx-content" class="ptx-content"><section class="section" id="sec-ac-python"><h2 class="heading hide-type">
<span class="type">Section</span><span class="space"> </span><span class="codenumber">3.8</span><span class="space"> </span><span class="title">Using Python in AC circuits</span>
</h2>
<div class="para" id="sec-ac-python-2">Just as with DC circuits, we can let Python do most of the mathematical manipulation for us when determining circuit behavior. As an example, we’ll examine the behavior of the circuit in <a href="sec-ac-python.html#ac-python-LRC-circuit" class="xref" data-knowl="./knowl/xref/ac-python-LRC-circuit.html" data-reveal-label="Reveal" data-close-label="Close" title="Figure 3.8.1">Figure 3.8.1</a>.</div>
<figure class="figure figure-like" id="ac-python-LRC-circuit"><div class="image-box" style="width: 50%; margin-left: 25%; margin-right: 25%;"><img src="generated/latex-image/ac-python-LRC-circuit-2.svg" role="img" class="contained"></div>
<figcaption><span class="type">Figure</span><span class="space"> </span><span class="codenumber">3.8.1<span class="period">.</span></span><span class="space"> </span>A generic LRC circuit. Let <span class="process-math">\(R=1\text{k}\Omega\text{,}\)</span> <span class="process-math">\(C=1 \mu\text{F}\text{,}\)</span> and <span class="process-math">\(L=1\text{mH}\)</span> for our analysis.</figcaption></figure><div class="para logical" id="sec-ac-python-4">
<div class="para">Using Kirchhoff’s laws and the branch method, we find the following equations</div>
<div class="displaymath process-math" id="sec-ac-python-4-1">
\begin{align*}
\tilde{I}_1 - \tilde{I}_2 - \tilde{I}_3 \amp = 0 \\
\tilde{V}_\text{in} - R \tilde{I}_1 - \frac{1}{i \omega C}  \tilde{I}_2 \amp = 0  \\
\frac{1}{i \omega C}\tilde{I}_2 - i\omega L \tilde{I}_3 \amp = 0 \text{.}
\end{align*}
</div>
<div class="para">Rearranging these equations</div>
<div class="displaymath process-math" id="sec-ac-python-4-2">
\begin{align*}
\tilde{I}_1 - \tilde{I}_2 - \tilde{I}_3 \amp = 0 \\
- R \tilde{I}_1 + \frac{i}{\omega C}  \tilde{I}_2 \amp = - \tilde{V}_\text{in}  \\
- \frac{i}{\omega C}\tilde{I}_2 - i\omega L \tilde{I}_3 \amp = 0 
\end{align*}
</div>
<div class="para">facilitates writing these equations as a matrix equation</div>
<div class="displaymath process-math">
\begin{equation*}
\begin{pmatrix} 
1 \amp - 1 \amp - 1 \\ 
-R_1  \amp \frac{i}{\omega C} \amp 0 \\ 
0 \amp -\frac{i}{\omega C} \amp - i\omega L 
\end{pmatrix} 
\begin{pmatrix} \tilde{I}_1 \\ \tilde{I}_2 \\ \tilde{I}_3 \end{pmatrix} =  
\begin{pmatrix} 0 \\ -\tilde{V}_\text{in} \\ 0 \end{pmatrix}
\end{equation*}
</div>
<div class="para">which can be solved using Python: <div id="sec-ac-python-4-4" class="ptx-sagecell sagecell-python"><script type="text/x-sage">import numpy as np
import scipy.linalg as linalg
import matplotlib.pyplot as plt

f = np.logspace(0,8,1000)
w_arr = 2*np.pi * f
Vin = 1 # Volts
R, C, L = [1000, 1e-9, 1e-3] # Ohms, Farads, Henrys

Gv = np.zeros(np.size(w_arr));
phi = np.zeros(np.size(w_arr));

for i in range(np.size(w_arr)):
    w = w_arr[i];
    A = np.array([[1, -1, -1],[-R, 1j/(w*C), 0],[0, -1j/(w*C), -1j*w*L]]);
    v = np.array([0, -Vin, 0]);
    
    x = linalg.solve(A,v);
    Gv[i] = np.abs(x[2]*1j*w*L) # Voltage Gain where I3=x[2]
    phi[i] = np.angle(x[2]*1j*w*L) # Phase of output (assuming Vin is at zero phase)

fig, axs = plt.subplots(2,1,sharex=True)

axs[0].semilogx(f,Gv)
axs[1].semilogx(f,phi)
# set labels -- Note that $\\phi$ is used in the ylabel below in order to avoid deprication warning
plt.setp(axs[0], ylabel='Voltage Gain')
plt.setp(axs[1], xlabel='Frequency (Hz)', ylabel='$\\phi_{out}-\\phi_{in}$', yticks=[-np.pi/2,0,np.pi/2], yticklabels=['$-\\pi/2$', 0, '$\\pi/2$']) 
plt.show()
</script></div> <div class="image-box" style="width: 100%; margin-left: 0%; margin-right: 0%;"><img src="generated/sageplot/sec-ac-python-4-5.svg" role="img" class="contained"></div>
</div>
</div>
<details id="sec-ac-python-5" class="example example-like born-hidden-knowl"><summary class="knowl__link"><h3 class="heading">
<span class="type">Example</span><span class="space"> </span><span class="codenumber">3.8.2</span><span class="period">.</span><span class="space"> </span><span class="title">Bandgap RLC Circuit.</span>
</h3></summary><article class="example example-like knowl__content"><figure class="figure figure-like" id="ac-python-bandgap-circuit"><div class="image-box" style="width: 100%; margin-left: 0%; margin-right: 0%;"><img src="generated/latex-image/ac-python-bandgap-circuit-2.svg" role="img" class="contained"></div>
<figcaption><span class="type">Figure</span><span class="space"> </span><span class="codenumber">3.8.3<span class="period">.</span></span><span class="space"> </span>Bandgap RLC Circuit.</figcaption></figure> <div class="para" id="sec-ac-python-5-2-2">Plot the gain and phase curves for the circuit in <a href="sec-ac-python.html#ac-python-bandgap-circuit" class="xref" data-knowl="./knowl/xref/ac-python-bandgap-circuit.html" data-reveal-label="Reveal" data-close-label="Close" title="Figure 3.8.3">Figure 3.8.3</a>.</div>
<div class="solutions">
<details id="sec-ac-python-5-3" class="answer solution-like born-hidden-knowl"><summary class="knowl__link"><span class="type">Answer</span><span class="period">.</span></summary><div class="answer solution-like knowl__content"><div class="image-box" style="width: 100%; margin-left: 0%; margin-right: 0%;"><img src="generated/sageplot/sec-ac-python-5-3-1.svg" role="img" class="contained"></div></div></details><details id="sec-ac-python-5-4" class="solution solution-like born-hidden-knowl"><summary class="knowl__link"><span class="type">Solution</span><span class="period">.</span></summary><div class="solution solution-like knowl__content">
<div class="para" id="sec-ac-python-5-4-1">If we examine the circuit in <a href="sec-ac-python.html#ac-python-bandgap-circuit" class="xref" data-knowl="./knowl/xref/ac-python-bandgap-circuit.html" data-reveal-label="Reveal" data-close-label="Close" title="Figure 3.8.3">Figure 3.8.3</a>, we find that it is exactly the same circuit as we examined in <a href="sec-ac-python.html#ac-python-LRC-circuit" class="xref" data-knowl="./knowl/xref/ac-python-LRC-circuit.html" data-reveal-label="Reveal" data-close-label="Close" title="Figure 3.8.1">Figure 3.8.1</a> except we are now measuring <span class="process-math">\(V_\text{out}\)</span> across the resistor instead of across the inductor and capacitor. This means that the matrix equation will be identical, as will our solutions for all of the currents.</div>
<div id="sec-ac-python-5-4-2" class="ptx-sagecell sagecell-python"><script type="text/x-sage">import numpy as np
import scipy.linalg as linalg
import matplotlib.pyplot as plt

f = np.logspace(0,8,10000)
w_arr = 2*np.pi * f
Vin = 1 # Volts
R, C, L = [1000, 1e-9, 1e-3] # Ohms, Farads, Henrys

Gv = np.zeros(np.size(w_arr));
phi = np.zeros(np.size(w_arr));

for i in range(np.size(w_arr)):
    w = w_arr[i];
    A = np.array([[1, -1, -1],[-R, 1j/(w*C), 0],[0, -1j/(w*C), -1j*w*L]]);
    v = np.array([0, -Vin, 0]);
    
    x = linalg.solve(A,v);
    Gv[i] = np.abs(x[0]*R) # Voltage Gain where I3=x[2]
    phi[i] = np.angle(x[0]*R) # Phase of output (assuming Vin is at zero phase)

fig, axs = plt.subplots(2,1,sharex=True)

axs[0].semilogx(f,Gv)
axs[1].semilogx(f,phi)
# set labels -- Note that $\\phi$ is used in the ylabel below in order to avoid deprication warning
plt.setp(axs[0], ylabel='Voltage Gain')
plt.setp(axs[1], xlabel='Frequency (Hz)', ylabel='$\\phi_{out}-\\phi_{in}$', yticks=[-np.pi/2,0,np.pi/2], yticklabels=['$-\\pi/2$', 0, '$\\pi/2$']) 
plt.show()
</script></div>
</div></details>
</div></article></details><details id="sec-ac-python-6" class="example example-like born-hidden-knowl"><summary class="knowl__link"><h3 class="heading">
<span class="type">Example</span><span class="space"> </span><span class="codenumber">3.8.4</span><span class="period">.</span><span class="space"> </span><span class="title">RLC Circuit Analysis Using Differential Equations and Python.</span>
</h3></summary><article class="example example-like knowl__content"></article></details></section></div>
<div class="ptx-content-footer">
<a class="previous-button button" href="sec-ac-phasors.html" title="Previous"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5cb;</span><span class="name">Prev</span></a><a class="top-button button" href="#" title="Top"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5ce;</span><span class="name">Top</span></a><a class="next-button button" href="sec-ac-thevenin.html" title="Next"><span class="name">Next</span><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5cc;</span></a>
</div></main>
</div>
<div id="ptx-page-footer" class="ptx-page-footer">
<a class="pretext-link" href="https://pretextbook.org" title="PreTeXt"><div class="logo"><svg xmlns="http://www.w3.org/2000/svg" height="100%" viewBox="338 3000 8772 6866"><g style="stroke-width:.025in; stroke:currentColor; fill:none"><polyline points="472,3590 472,9732 " style="stroke-width:174; stroke-linejoin:miter; stroke-linecap:round; "></polyline><path style="stroke-width:126;stroke-linecap:butt;" d="M 4724,9448 A 4660 4660  0  0  1  8598  9259"></path><path style="stroke-width:174;stroke-linecap:butt;" d="M 4488,9685 A 4228 4228  0  0  0   472  9732"></path><path style="stroke-width:126;stroke-linecap:butt;" d="M 4724,3590 A 4241 4241  0  0  1  8598  3496"></path><path style="stroke-width:126;stroke-linecap:round;" d="M 850,3496  A 4241 4241  0  0  1  4724  3590"></path><path style="stroke-width:126;stroke-linecap:round;" d="M 850,9259  A 4507 4507  0  0  1  4724  9448"></path><polyline points="5385,4299 4062,8125" style="stroke-width:300; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="8598,3496 8598,9259" style="stroke-width:126; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="850,3496 850,9259" style="stroke-width:126; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="4960,9685 4488,9685" style="stroke-width:174; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="3070,4582 1889,6141 3070,7700" style="stroke-width:300; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="6418,4582 7600,6141 6418,7700" style="stroke-width:300; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="8976,3590 8976,9732" style="stroke-width:174; stroke-linejoin:miter; stroke-linecap:round;"></polyline><path style="stroke-width:174;stroke-linecap:butt;" d="M 4960,9685 A 4228 4228  0  0  1  8976  9732"></path></g></svg></div></a><a class="runestone-link" href="https://runestone.academy" title="Runestone Academy"><img class="logo" src="https://runestone.academy/runestone/static/images/RAIcon_cropped.png"></a><a class="mathjax-link" href="https://www.mathjax.org" title="MathJax"><img class="logo" src="https://www.mathjax.org/badge/badge-square-2.png"></a>
</div>
</body>
</html>
