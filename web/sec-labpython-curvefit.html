<!DOCTYPE html>
<!--********************************************-->
<!--*       Generated from PreTeXt source      *-->
<!--*                                          *-->
<!--*         https://pretextbook.org          *-->
<!--*                                          *-->
<!--********************************************-->
<html lang="en-US" dir="ltr">
<!--******************************************-->
<!--*  Authored with PreTeXt                 *-->
<!--*  pretextbook.org                       *-->
<!--*  Theme: denver                         *-->
<!--*  Palette:                              *-->
<!--******************************************-->
<head xmlns:og="http://ogp.me/ns#" xmlns:book="https://ogp.me/ns/book#">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Fitting a Curve to Data</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0">
<link href="_static/pretext/css/theme.css" rel="stylesheet" type="text/css">
<script>
var runestoneMathReady = new Promise((resolve) => window.rsMathReady = resolve);
window.MathJax = {
  "tex": {
    "inlineMath": [
      [
        "\\(",
        "\\)"
      ]
    ],
    "tags": "none",
    "tagSide": "right",
    "tagIndent": ".8em",
    "packages": {
      "[+]": [
        "base",
        "extpfeil",
        "ams",
        "amscd",
        "color",
        "newcommand",
        "knowl"
      ]
    }
  },
  "options": {
    "ignoreHtmlClass": "tex2jax_ignore|ignore-math",
    "processHtmlClass": "process-math",
    "renderActions": {
      "findScript": [
        10,
        function (doc) {
            document.querySelectorAll('script[type^="math/tex"]').forEach(function(node) {
                var display = !!node.type.match(/; *mode=display/);
                var math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
                var text = document.createTextNode('');
                node.parentNode.replaceChild(text, node);
                math.start = {node: text, delim: '', n: 0};
                math.end = {node: text, delim: '', n: 0};
                doc.math.push(math);
            });
        },
        ""
      ]
    }
  },
  "chtml": {
    "scale": 0.98,
    "mtextInheritFont": true
  },
  "loader": {
    "load": [
      "input/asciimath",
      "[tex]/extpfeil",
      "[tex]/amscd",
      "[tex]/color",
      "[tex]/newcommand",
      "[pretext]/mathjaxknowl3.js"
    ],
    "paths": {
      "pretext": "_static/pretext/js"
    }
  },
  "startup": {
    pageReady() {
      return MathJax.startup.defaultPageReady().then(function () {
      console.log("in ready function");
      rsMathReady();
      }
    )}
  }
};
</script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script><meta name="Keywords" content="Authored in PreTeXt">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta property="og:type" content="book">
<meta property="book:title" content="Electronics">
<meta property="book:author" content="Derek J. Thuecks">
<script src="_static/pretext/js/jquery.min.js"></script><script src="_static/pretext/js/pretext.js"></script><script src="_static/pretext/js/pretext_add_on.js?x=1"></script><!--** eBookCongig is necessary to configure interactive       **-->
<!--** Runestone components to run locally in reader's browser **-->
<!--** No external communication:                              **-->
<!--**     log level is 0, Runestone Services are disabled     **-->
<script type="text/javascript">
eBookConfig = {};
eBookConfig.useRunestoneServices = false;
eBookConfig.host = 'http://127.0.0.1:8000';
eBookConfig.course = 'PTX_Course_Title_Here';
eBookConfig.basecourse = 'PTX_Base_Course';
eBookConfig.isLoggedIn = false;
eBookConfig.email = '';
eBookConfig.isInstructor = false;
eBookConfig.logLevel = 0;
eBookConfig.username = '';
eBookConfig.readings = null;
eBookConfig.activities = null;
eBookConfig.downloadsEnabled = false;
eBookConfig.allow_pairs = false;
eBookConfig.enableScratchAC = false;
eBookConfig.build_info = "";
eBookConfig.python3 = null;
eBookConfig.runestone_version = '7.11.15';
eBookConfig.jobehost = '';
eBookConfig.proxyuri_runs = '';
eBookConfig.proxyuri_files = '';
eBookConfig.enable_chatcodes =  false;
</script>
<!--*** Runestone Services ***-->
<script src="_static/prefix-runtime.529fd9398bfbd03e.bundle.js"></script><script src="_static/prefix-723.3e6434f80549315a.bundle.js"></script><script src="_static/prefix-runestone.1d6e4aba17c2c7f2.bundle.js"></script><link rel="stylesheet" type="text/css" href="_static/prefix-723.3bccd435914aa0ff.css">
<link rel="stylesheet" type="text/css" href="_static/prefix-runestone.6ec5960970d8b364.css">
<script src="https://sagecell.sagemath.org/static/embedded_sagecell.js"></script><script src="_static/pretext/js/lti_iframe_resizer.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.26.0/components/prism-core.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.26.0/plugins/autoloader/prism-autoloader.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.26.0/plugins/line-numbers/prism-line-numbers.min.js" integrity="sha512-dubtf8xMHSQlExGRQ5R7toxHLgSDZ0K7AunqPWHXmJQ8XyVIG19S1T95gBxlAeGOK02P4Da2RTnQz0Za0H0ebQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.26.0/plugins/line-highlight/prism-line-highlight.min.js" integrity="sha512-93uCmm0q+qO5Lb1huDqr7tywS8A2TFA+1/WHvyiWaK6/pvsFl6USnILagntBx8JnVbQH5s3n0vQZY6xNthNfKA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/lunr.js/2.3.9/lunr.min.js" integrity="sha512-4xUl/d6D6THrAnXAwGajXkoWaeMNwEKK4iNfq5DotEbLPAfk6FSxSP3ydNxqDgCw1c/0Z1Jg6L8h2j+++9BZmg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><script src="lunr-pretext-search-index.js" async=""></script><script src="_static/pretext/js/pretext_search.js"></script><script src="_static/pretext/js/knowl.js"></script><!--knowl.js code controls Sage Cells within knowls--><script>sagecellEvalName='Evaluate (Sage)';
</script><script>// Make *any* div with class 'sagecell-python' an executable Sage cell
// Their results will be linked, only within language type
sagecell.makeSagecell({
  "inputLocation": "div.sagecell-python",
  "linked": true,
  "linkKey": "linked-python",
  "autoeval": false,
  "languages": [
    "python"
  ],
  "evalButtonText": "Evaluate (Python)"
});
</script>
</head>
<body id="electronics.thuecks" class="pretext book ignore-math">
<a class="assistive" href="#ptx-content">Skip to main content</a><header id="ptx-masthead" class="ptx-masthead"><div class="ptx-banner"><div class="title-container">
<h1 class="heading"><a href="Electronics.html"><span class="title">Electronics</span> <span class="subtitle">A Guide for Physicists (DRAFT -- in development)</span></a></h1>
<p class="byline">Derek J. Thuecks</p>
</div></div></header><nav id="ptx-navbar" class="ptx-navbar navbar"><div class="ptx-navbar-contents">
<button class="toc-toggle button" title="Contents"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5d2;</span><span class="name">Contents</span></button><div class="searchbox">
<div class="searchwidget"><button id="searchbutton" class="searchbutton button" type="button" title="Search book"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe8b6;</span><span class="name">Search Book</span></button></div>
<div id="searchresultsplaceholder" class="searchresultsplaceholder" style="display: none">
<div class="search-results-controls">
<input aria-label="Search term" id="ptxsearch" class="ptxsearch" type="text" name="terms" placeholder="Search term"><button title="Close search" id="closesearchresults" class="closesearchresults"><span class="material-symbols-outlined">close</span></button>
</div>
<h2 class="search-results-heading">Search Results: </h2>
<div id="searchempty" class="searchempty"><span>No results.</span></div>
<ol id="searchresults" class="searchresults"></ol>
</div>
</div>
<span class="nav-other-controls"><button id="light-dark-button" class="light-dark-button button" title="Dark Mode"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe51c;</span><span class="name">Dark Mode</span></button></span><span class="treebuttons"><a class="previous-button button" href="sec-labpython-plotting.html" title="Previous"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5cb;</span><span class="name">Prev</span></a><a class="up-button button" href="ch-labpython.html" title="Up"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5ce;</span><span class="name">Up</span></a><a class="next-button button" href="sec-labpython-montecarlo.html" title="Next"><span class="name">Next</span><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5cc;</span></a></span>
</div></nav><div id="latex-macros" class="hidden-content process-math" style="display:none"><span class="process-math">\(\newcommand{\vect}[1]{\mathbf{#1}}
\newcommand{\lt}{&lt;}
\newcommand{\gt}{&gt;}
\newcommand{\amp}{&amp;}
\definecolor{fillinmathshade}{gray}{0.9}
\newcommand{\fillinmath}[1]{\mathchoice{\colorbox{fillinmathshade}{$\displaystyle     \phantom{\,#1\,}$}}{\colorbox{fillinmathshade}{$\textstyle        \phantom{\,#1\,}$}}{\colorbox{fillinmathshade}{$\scriptstyle      \phantom{\,#1\,}$}}{\colorbox{fillinmathshade}{$\scriptscriptstyle\phantom{\,#1\,}$}}}
\)</span></div>
<div class="ptx-page">
<div id="ptx-sidebar" class="ptx-sidebar"><nav id="ptx-toc" class="ptx-toc depth4 parts focused" data-preexpanded-levels="0" data-max-levels="4"><ul class="structural toc-item-list contains-active">
<li class="toc-item toc-frontmatter"><div class="toc-title-box"><a href="frontmatter.html" class="internal"><span class="title">Front Matter</span></a></div></li>
<li class="toc-item toc-part">
<div class="toc-title-box"><a href="part-analysis.html" class="internal"><span class="codenumber">I</span> <span class="title">Circuit Analysis</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-chapter">
<div class="toc-title-box"><a href="ch-introduction.html" class="internal"><span class="codenumber">1</span> <span class="title">Introduction</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-introduction-review.html" class="internal"><span class="codenumber">1.1</span> <span class="title">Review from Introductory Physics</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-circuit-schematics.html" class="internal"><span class="codenumber">1.2</span> <span class="title">Circuit Schematic: A Visual Model of a Circuit</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-chapter">
<div class="toc-title-box"><a href="ch-dc.html" class="internal"><span class="codenumber">2</span> <span class="title">DC Circuits</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-dc-kirchhoff.html" class="internal"><span class="codenumber">2.1</span> <span class="title">Kirchhoffâ€™s Laws</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-dc-voltage-source-symbol.html" class="internal"><span class="codenumber">2.2</span> <span class="title">Voltage Source Symbols</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-dc-series_parallel.html" class="internal"><span class="codenumber">2.3</span> <span class="title">Series and Parallel Resistors</span></a></div></li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-dc-analysis.html" class="internal"><span class="codenumber">2.4</span> <span class="title">Circuit Analysis Methods</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-dc-analysis.html#subsec-dc-analysis-reduction" class="internal"><span class="codenumber">2.4.1</span> <span class="title">Analysis: Circuit Reduction</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-dc-analysis.html#subsec-dc-analysis-branch" class="internal"><span class="codenumber">2.4.2</span> <span class="title">Analysis: Branch Method</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-dc-analysis.html#subsec-dc-analysis-mesh" class="internal"><span class="codenumber">2.4.3</span> <span class="title">Analysis: Mesh Method</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-dc-superposition.html" class="internal"><span class="codenumber">2.5</span> <span class="title">Superposition Theorem</span></a></div></li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-dc-thevenin.html" class="internal"><span class="codenumber">2.6</span> <span class="title">ThÃ©veninâ€™s and Nortonâ€™s Theorems</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-dc-thevenin.html#subsec-dc-thevenin-norton-circuits" class="internal"><span class="codenumber">2.6.1</span> <span class="title">Behavior of ThÃ©venin/Norton circuits</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-dc-thevenin.html#subsec-dc-proof-thevenin" class="internal"><span class="codenumber">2.6.2</span> <span class="title">Proof of Theveninâ€™s and Nortonâ€™s Theorems</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-dc-thevenin.html#subsec-finding-thevenin" class="internal"><span class="codenumber">2.6.3</span> <span class="title">Finding Thevenin Equivalent Circuits</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-dc-batteries.html" class="internal"><span class="codenumber">2.7</span> <span class="title">Application of Thevenin Equivalent Cicruits: Batteries</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-dc-uses.html" class="internal"><span class="codenumber">2.8</span> <span class="title">DC Circuit Uses</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-chapter">
<div class="toc-title-box"><a href="ch-ac.html" class="internal"><span class="codenumber">3</span> <span class="title">AC Circuits</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-ac-sinusoidal.html" class="internal"><span class="codenumber">3.1</span> <span class="title">Sinusoidal Signals</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-ac-amplitudes.html" class="internal"><span class="codenumber">3.2</span> <span class="title">Characterizing Signal Size</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-ac-complexsigs.html" class="internal"><span class="codenumber">3.3</span> <span class="title">Complex Signals</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-ac-complexZ.html" class="internal"><span class="codenumber">3.4</span> <span class="title">Complex Impedance</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-ac-capcharging.html" class="internal"><span class="codenumber">3.5</span> <span class="title">Capacitor Charging and Discharging Behaviors</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-ac-highpass.html" class="internal"><span class="codenumber">3.6</span> <span class="title">RC High-pass filter</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-ac-phasors.html" class="internal"><span class="codenumber">3.7</span> <span class="title">Phasors</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-ac-python.html" class="internal"><span class="codenumber">3.8</span> <span class="title">Using Python in AC circuits</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-ac-thevenin.html" class="internal"><span class="codenumber">3.9</span> <span class="title">Input and Output Impedance</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-chapter">
<div class="toc-title-box"><a href="ch-diode.html" class="internal"><span class="codenumber">4</span> <span class="title">Diodes</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-diode-semiconductors.html" class="internal"><span class="codenumber">4.1</span> <span class="title">Semiconductors</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-diode-behavior.html" class="internal"><span class="codenumber">4.2</span> <span class="title">Diode behavior</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-diode-types.html" class="internal"><span class="codenumber">4.3</span> <span class="title">Diode Types</span></a></div></li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-diode-circuit-analytic.html" class="internal"><span class="codenumber">4.4</span> <span class="title">Analysis of diode circuits</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-diode-circuit-analytic.html#sub-diode-analytic-analysis" class="internal"><span class="codenumber">4.4.1</span> <span class="title">Analytic circuit treatment</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-diode-circuit-analytic.html#sub-diode-python-analysis" class="internal"><span class="codenumber">4.4.2</span> <span class="title">Python circuit treatment</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-diode-rectifier.html" class="internal"><span class="codenumber">4.5</span> <span class="title">Full-Wave Rectifier</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-diode-usefulcircuits.html" class="internal"><span class="codenumber">4.6</span> <span class="title">Useful Diode Circuits</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-chapter">
<div class="toc-title-box"><a href="ch-transistor.html" class="internal"><span class="codenumber">5</span> <span class="title">Transistors</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-transistor-introduction.html" class="internal"><span class="codenumber">5.1</span> <span class="title">Introduction to transistors</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-transistor-behavior.html" class="internal"><span class="codenumber">5.2</span> <span class="title">Transistor behavior</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-transistor-switching.html" class="internal"><span class="codenumber">5.3</span> <span class="title">Transistor switching</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-chapter">
<div class="toc-title-box"><a href="ch-opamp.html" class="internal"><span class="codenumber">6</span> <span class="title">Operational Amplifiers</span></a></div>
<ul class="structural toc-item-list"><li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-opamp-ideal.html" class="internal"><span class="codenumber">6.1</span> <span class="title">The Ideal OpAmp</span></a></div></li></ul>
</li>
<li class="toc-item toc-chapter"><div class="toc-title-box"><a href="ch-digital.html" class="internal"><span class="codenumber">7</span> <span class="title">Digital Electronics</span></a></div></li>
<li class="toc-item toc-chapter"><div class="toc-title-box"><a href="ch-advancedcircuits.html" class="internal"><span class="codenumber">8</span> <span class="title">Advanced Circuits</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-part contains-active">
<div class="toc-title-box"><a href="part-lab.html" class="internal"><span class="codenumber">II</span> <span class="title">Laboratory</span></a></div>
<ul class="structural toc-item-list contains-active">
<li class="toc-item toc-chapter"><div class="toc-title-box"><a href="ch-safety.html" class="internal"><span class="codenumber">9</span> <span class="title">Lab Safety</span></a></div></li>
<li class="toc-item toc-chapter"><div class="toc-title-box"><a href="ch-labnotebook.html" class="internal"><span class="codenumber">10</span> <span class="title">Guide to Laboratory Notebooks</span></a></div></li>
<li class="toc-item toc-chapter">
<div class="toc-title-box"><a href="ch-equipment.html" class="internal"><span class="codenumber">11</span> <span class="title">Introduction to Equipment in the Laboratory</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-equipment-protoboard.html" class="internal"><span class="codenumber">11.1</span> <span class="title">Prototyping Board (or Breadboard)</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-equipment-dmm.html" class="internal"><span class="codenumber">11.2</span> <span class="title">Digital Multimeter (DMM)</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-equipment-oscilloscope.html" class="internal"><span class="codenumber">11.3</span> <span class="title">Oscilloscopes (BK Precision 2190E or 2542B)</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-equipment-fngen.html" class="internal"><span class="codenumber">11.4</span> <span class="title">Function Generator</span></a></div></li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-equipment-components.html" class="internal"><span class="codenumber">11.5</span> <span class="title">Electronics components</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-equipment-components.html#sec-components-color-codes" class="internal"><span class="codenumber">11.5.1</span> <span class="title">Resistor Color Codes</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-equipment-components.html#sec-components-potentiometers" class="internal"><span class="codenumber">11.5.2</span> <span class="title">Potentiometers</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-equipment-components.html#subsec-components-switches" class="internal"><span class="codenumber">11.5.3</span> <span class="title">Switches</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-equipment-components.html#subsec-components-cables-connectors" class="internal"><span class="codenumber">11.5.4</span> <span class="title">Wires, Cables, and Connectors</span></a></div></li>
</ul>
</li>
</ul>
</li>
<li class="toc-item toc-chapter"><div class="toc-title-box"><a href="ch-labhints.html" class="internal"><span class="codenumber">12</span> <span class="title">Troubleshooting Hints</span></a></div></li>
<li class="toc-item toc-chapter contains-active">
<div class="toc-title-box"><a href="ch-labpython.html" class="internal"><span class="codenumber">13</span> <span class="title">Data Analysis with Python</span></a></div>
<ul class="structural toc-item-list contains-active">
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-labpython-dataload.html" class="internal"><span class="codenumber">13.1</span> <span class="title">Loading Data Files</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-labpython-plotting.html" class="internal"><span class="codenumber">13.2</span> <span class="title">Producing Line Plots</span></a></div></li>
<li class="toc-item toc-section active"><div class="toc-title-box"><a href="sec-labpython-curvefit.html" class="internal"><span class="codenumber">13.3</span> <span class="title">Fitting a Curve to Data</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-labpython-montecarlo.html" class="internal"><span class="codenumber">13.4</span> <span class="title">Propagating Uncertainties Through Curve Fits</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-chapter">
<div class="toc-title-box"><a href="ch-labactivities.html" class="internal"><span class="codenumber">14</span> <span class="title">Lab Activities</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-labactivities-voltagedivider.html" class="internal"><span class="codenumber">14.1</span> <span class="title">Lab: Voltage Divider</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-labactivities-oscilloscopeprimer.html" class="internal"><span class="codenumber">14.2</span> <span class="title">Lab: Oscilloscope Primer</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-labactivities-rc-highpass.html" class="internal"><span class="codenumber">14.3</span> <span class="title">Lab: RC High-Pass Filter</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-labactivities-rlc-resonant.html" class="internal"><span class="codenumber">14.4</span> <span class="title">Lab: RLC Resonant Circuit</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-labactivities-diode-iv-characteristic.html" class="internal"><span class="codenumber">14.5</span> <span class="title">Lab: I-V Characteristic for Diodes</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-labactivities-diode-ac2dc.html" class="internal"><span class="codenumber">14.6</span> <span class="title">Lab: AC to DC Conversion Using Diode Bridge Rectifier</span></a></div></li>
</ul>
</li>
</ul>
</li>
<li class="toc-item toc-backmatter">
<div class="toc-title-box"><a href="backmatter.html" class="internal"><span class="title">Appendices</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-appendix">
<div class="toc-title-box"><a href="app-python.html" class="internal"><span class="codenumber">A</span> <span class="title">Numerical Methods</span></a></div>
<ul class="structural toc-item-list"><li class="toc-item toc-section"><div class="toc-title-box"><a href="subapp-python-newtonmethod.html" class="internal"><span class="codenumber">A.1</span> <span class="title">Newtonâ€™s Method</span></a></div></li></ul>
</li>
<li class="toc-item toc-appendix"><div class="toc-title-box"><a href="app-matrices.html" class="internal"><span class="codenumber">B</span> <span class="title">Matrices</span></a></div></li>
<li class="toc-item toc-colophon"><div class="toc-title-box"><a href="backmatter-4.html" class="internal"><span class="title">Colophon</span></a></div></li>
</ul>
</li>
</ul></nav></div>
<main class="ptx-main"><div id="ptx-content" class="ptx-content"><section class="section" id="sec-labpython-curvefit"><h2 class="heading hide-type">
<span class="type">Section</span><span class="space heading-divison-mark heading-divison-mark__space"> </span><span class="codenumber">13.3</span><span class="space heading-divison-mark heading-divison-mark__space"> </span><span class="title">Fitting a Curve to Data</span>
</h2>
<div class="para" id="sec-labpython-curvefit-2">Frequently, curve fitting will be used to extract results from experimental data. In this section, we demonstrate use of <code class="code-inline tex2jax_ignore">scipy.optimize.curve_fit</code>, the curve fitting function provided within SciPy.<div class="autopermalink" data-description="Paragraph"><a href="#sec-labpython-curvefit-2" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">ðŸ”—</a></div>
</div>
<div class="para logical" id="sec-labpython-curvefit-3">
<div class="para">Letâ€™s illustrate this process through an example. Assume that we have conducted an experiment in which we investigated the behavior of a voltage divider circuit shown in <a href="sec-labpython-plotting.html#fig-labpython-vdiv-circuit" class="xref" data-knowl="./knowl/xref/fig-labpython-vdiv-circuit.html" data-reveal-label="Reveal" data-close-label="Close" title="Figure 13.2.1">FigureÂ 13.2.1</a> where <span class="process-math">\(V_\text{in}\)</span> and <span class="process-math">\(R_\text{fixed}\)</span> are treated as being unknown. We collect measurements of <span class="process-math">\(V_\text{out}\)</span> as we vary and measure <span class="process-math">\(R_\text{pot}\text{.}\)</span> A curve fitting process can then be employed to find <span class="process-math">\(V_\text{in}\)</span> and <span class="process-math">\(R_\text{fixed}\)</span> from fit parameters, where</div>
<div class="displaymath process-math" data-contains-math-knowls="./knowl/xref/fig-labpython-vdiv-circuit.html" id="eqn-labpython-curvefit-theory">
\begin{equation}
V_\text{out}=\frac{R_\text{pot}}{R+R_\text{pot}}\tag{13.3.1}
\end{equation}
</div>
<div class="para">is our fitting function. Here, an executable routine is provided that uses the <code class="code-inline tex2jax_ignore">curve_fit</code> function from the <code class="code-inline tex2jax_ignore">scipy.optimize</code> module to perform a curve fit to data, with a code break-down with explanation following. When examining the results provided by this curve fitting routine, note that values of <span class="process-math">\(V_\text{in}=5.0\text{V}\)</span> and <span class="process-math">\(R_\text{fixed}=5\text{k}\Omega\)</span> were used when generating the synthetic data in this example.</div>
<div class="autopermalink" data-description="Paragraph"><a href="#sec-labpython-curvefit-3" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">ðŸ”—</a></div>
</div>
<div id="sec-labpython-curvefit-4" class="ptx-sagecell sagecell-python"><script type="text/x-sage"># FULL ROUTINE

# Clear all variables from previous code runs
globals().clear() 

# Import functions for use in this program 
import numpy as np
import scipy.optimize as opt
import matplotlib.pyplot as plt

# Close all open figures
plt.close('all') 

# Define our fitting function
def func(R, Vin, Rfix):
    out = Vin * R/(Rfix + R)
    return out

# Create arrays containing data from experiment 
Rpot = np.array([1000, 2000, 3000, 4000, 5000, 6000, 7000, 8000, 9000, 10000]);
Vout = np.array([0.815, 1.332, 1.880, 2.238, 2.614, 2.777, 2.881, 3.289, 2.974, 3.096]);

# Perform curve fitting
fit, fit_cov = opt.curve_fit(func, Rpot, Vout);

# Calculate standard deviation on fit parameters (associated with data scatter)
sigma=np.sqrt(np.diag(fit_cov));

# Print values and uncertainties for fit parameters
print('Vin={0:.2f}V +/- {1:.2f}V and Rfixed={2:.2f}ohms +/- {3:.2f}ohms'.format(fit[0],sigma[0],fit[1], sigma[1]))

# Create arrays containing values for the best fit curve (useful for plotting best fit curve)
Rpot_fit=np.linspace(0,10000, 100);
Vout_fit=fit[0]*Rpot_fit/(fit[1]+Rpot_fit);

# Plot experiment data and best fit curve on the same axes
plt.plot(Rpot, Vout, 'o', label='Data');
plt.plot(Rpot_fit, Vout_fit, label='Fit')
plt.xlim(0,10500);
plt.ylim(0,3.5);
plt.xlabel(r'Resistance ($\Omega$)')
plt.ylabel(r'$V_\text{out}$')
plt.legend();
plt.show();
</script></div>
<section class="paragraphs" id="sec-labpython-curvefit-5"><h3 class="heading"><span class="title">Breakdown of curve fitting routine.</span></h3>
<div class="para" id="sec-labpython-curvefit-5-2">Letâ€™s take a closer look at the pieces that go into this Python routine. We start by initializing our variable and function space. <div class="code-box"><pre class="program clipboardable"><code class="language-py"># Clear all variables from previous code runs
globals().clear() 

# Import functions for use in this program 
import numpy as np
import scipy.optimize as opt
import matplotlib.pyplot as plt

# Close all open figures
plt.close('all')
</code></pre></div> We ensure that all variables in the variable-space are cleared out and donâ€™t carry over from other code boxes in the textbook. We then import functions from NumPy, SciPy, and MatPlotLib.pyplot packages that weâ€™ll wish to use. Finally, we close all plot windows that may exist from other instances of running code in this textbook.<div class="autopermalink" data-description="Paragraph"><a href="#sec-labpython-curvefit-5-2" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">ðŸ”—</a></div>
</div>
<div class="para" id="sec-labpython-curvefit-5-3">The <code class="code-inline tex2jax_ignore">curve_fit</code> function that we intend to use must be given information about the functional form of our fitting equation. This information will be provided by a function <code class="code-inline tex2jax_ignore">func</code> that we define based on Equation <a href="sec-labpython-curvefit.html#eqn-labpython-curvefit-theory" class="xref" data-knowl="./knowl/xref/eqn-labpython-curvefit-theory.html" data-reveal-label="Reveal" data-close-label="Close" title="Equation 13.3.1">(13.3.1)</a>. Once defined, <code class="code-inline tex2jax_ignore">func</code> will be an input provided to the <code class="code-inline tex2jax_ignore">curve_fit</code> function. <div class="code-box"><pre class="program clipboardable"><code class="language-py"># Define our fitting function
def func(R, Vin, Rfix):
    out = Vin * R/(Rfix + R)
    return out
</code></pre></div> The first line of our function definition always begins with <code class="code-inline tex2jax_ignore">def</code>, followed by the name of the function weâ€™re defining and its arguments. The <code class="code-inline tex2jax_ignore">curve_fit</code> function expects the first argument of <code class="code-inline tex2jax_ignore">func</code> to represent our dataâ€™s independent variable (often the horizontal axis of a plot). In this example, <code class="code-inline tex2jax_ignore">R</code> will represent <span class="process-math">\(R_\text{pot}\text{.}\)</span> Any additional arguments specified for <code class="code-inline tex2jax_ignore">func</code> represent fitting parameters that will be determined by the curve fitting process. In this example, these fit parameters <code class="code-inline tex2jax_ignore">Vin</code> and <code class="code-inline tex2jax_ignore">Rfix</code> will represent <span class="process-math">\(V_\text{in}\)</span> and <span class="process-math">\(R_\text{fixed}\)</span> respectively. The next line(s) contain the actual functional form for our fitting function which will be dictated by Equation <a href="sec-labpython-curvefit.html#eqn-labpython-curvefit-theory" class="xref" data-knowl="./knowl/xref/eqn-labpython-curvefit-theory.html" data-reveal-label="Reveal" data-close-label="Close" title="Equation 13.3.1">(13.3.1)</a> in terms of the argument names above. The <code class="code-inline tex2jax_ignore">out</code> variable represents our dataâ€™s dependent variable (often the vertical axis of a plot) and represents <span class="process-math">\(V_\text{out}\)</span> in this example. The final line of the function definition for <code class="code-inline tex2jax_ignore">func</code> will return to <code class="code-inline tex2jax_ignore">curve_fit</code> a value of <code class="code-inline tex2jax_ignore">out</code> based on the argument values that <code class="code-inline tex2jax_ignore">curve_fit</code> provided to <code class="code-inline tex2jax_ignore">func</code>.<div class="autopermalink" data-description="Paragraph"><a href="#sec-labpython-curvefit-5-3" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">ðŸ”—</a></div>
</div>
<div class="para" id="sec-labpython-curvefit-5-4">The next lines of code represent the introduction of experimental data <span class="process-math">\(\left(R_\text{pot}, V_\text{out}\right)\)</span> into the routine. There are only ten data points in this example, so it is not too onerous to enter the data by hand directly into the routine. For larger data sets, it is instead recommended that data import routines similar to those shown in <a href="sec-labpython-dataload.html" class="internal" title="Section 13.1: Loading Data Files">SectionÂ 13.1</a> be used. <div class="code-box"><pre class="program clipboardable"><code class="language-py"># Create arrays containing data from experiment 
Rpot = np.array([1000, 2000, 3000, 4000, 5000, 6000, 7000, 8000, 9000, 10000]);
Vout = np.array([0.815, 1.332, 1.880, 2.238, 2.614, 2.777, 2.881, 3.289, 2.974, 3.096]);
</code></pre></div>
<div class="autopermalink" data-description="Paragraph"><a href="#sec-labpython-curvefit-5-4" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">ðŸ”—</a></div>
</div>
<div class="para" id="sec-labpython-curvefit-5-5">We are now ready to perform a curve fit to our data. The <code class="code-inline tex2jax_ignore">curve_fit</code> function takes as inputs the name of the fitting function, the variable name for the independent variable, and the variable name for the dependent variable. Further inputs and options are available but optional, and can be found in official documentation for SciPy. <div class="code-box"><pre class="program clipboardable"><code class="language-py"># Perform curve fitting
fit, fit_cov = opt.curve_fit(func, Rpot, Vout);
</code></pre></div> Here, we provide the name of our defined function <code class="code-inline tex2jax_ignore">func</code>, the name of our independent variable data <code class="code-inline tex2jax_ignore">Rpot</code>, and the name of our dependent variable data <code class="code-inline tex2jax_ignore">Vout</code>. The <code class="code-inline tex2jax_ignore">curve_fit</code> function will then return its estimate for values of the fit parameters as an array of values in <code class="code-inline tex2jax_ignore">fit</code> and something called the covariance as an array of values in <code class="code-inline tex2jax_ignore">fit_cov</code>. A full description of the meaning of the covariance matrix can be found in data analysis or statistics texts. For our purposes, the covariance can be used to provide estimates of the one standard deviation uncertainty (arising from scatter in the data) for each of the fit parameters stored in <code class="code-inline tex2jax_ignore">fit</code>. <div class="code-box"><pre class="program clipboardable"><code class="language-py"># Calculate standard deviation on fit parameters (associated with data scatter)
sigma=np.sqrt(np.diag(fit_cov));
</code></pre></div>
<div class="autopermalink" data-description="Paragraph"><a href="#sec-labpython-curvefit-5-5" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">ðŸ”—</a></div>
</div>
<div class="para" id="sec-labpython-curvefit-5-6">Estimates for the fit parameters and data-scatter uncertainties are printed for the user. <div class="code-box"><pre class="program clipboardable"><code class="language-py"># Print values and uncertainties for fit parameters
print('Vin={0:.2f}V +/- {1:.2f}V and Rfixed={2:.2f}ohms +/- {3:.2f}ohms'.format(fit[0],sigma[0],fit[1], sigma[1]))
</code></pre></div> In this print command, the structure of the string that will be displayed is provided first, followed by values taken from variables present in our program. As an example, the portion of the command reading <code class="code-inline tex2jax_ignore">Rfixed={2:.2f}ohms</code> indicates that the spot enclosed by the curly brackets should be replaced by the second element (since the number before the colon is a â€˜2â€™) in the <code class="code-inline tex2jax_ignore">format</code> attribute (<code class="code-inline tex2jax_ignore">fit[1]</code> in this case). The â€˜:.2fâ€™ indicates that the number placed in this spot should be a floating point number (because of the â€˜fâ€™) that is truncated two digits after the decimal point (because of the â€˜:.2â€™). To better demonstrate this functionality, an alternative set of print commands, shown here, could have been used to split the statement of results into two lines of text. <div class="code-box"><pre class="program clipboardable"><code class="language-py"># Print values and uncertainties for fit parameters
print('Vin={0:.2f}V +/- {1:.2f}V '.format(fit[0],sigma[0]))
print('Rfixed={0:.2f}ohms +/- {1:.2f}ohms'.format(fit[1], sigma[1]))
</code></pre></div>
<div class="autopermalink" data-description="Paragraph"><a href="#sec-labpython-curvefit-5-6" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">ðŸ”—</a></div>
</div>
<div class="para" id="sec-labpython-curvefit-5-7">To produce a theory curve based on these fit parameters, we first generate an array of values for <span class="process-math">\(R_\text{pot}\)</span> associated with our theoretical prediction, and then evaluate a theoretical prediction for <span class="process-math">\(V_\text{out}\)</span> for each of these <span class="process-math">\(R_\text{pot}\)</span> values. <div class="code-box"><pre class="program clipboardable"><code class="language-py"># Create arrays containing values for the best fit curve 
Rpot_fit=np.linspace(0,10000, 100);
Vout_fit=fit[0]*Rpot_fit/(fit[1]+Rpot_fit);
</code></pre></div> Here, <code class="code-inline tex2jax_ignore">Rpot_fit</code> is an array containing 100 values spaced linearly in the range (0,10000). These values are plugged into Equation <a href="sec-labpython-curvefit.html#eqn-labpython-curvefit-theory" class="xref" data-knowl="./knowl/xref/eqn-labpython-curvefit-theory.html" data-reveal-label="Reveal" data-close-label="Close" title="Equation 13.3.1">(13.3.1)</a> to generate an array of values for <code class="code-inline tex2jax_ignore">Vout_fit</code> .<div class="autopermalink" data-description="Paragraph"><a href="#sec-labpython-curvefit-5-7" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">ðŸ”—</a></div>
</div>
<div class="para" id="sec-labpython-curvefit-5-8">The remainder of the code contains plotting commands along the lines of those discussed in <a href="sec-labpython-plotting.html" class="internal" title="Section 13.2: Producing Line Plots">SectionÂ 13.2</a>. <div class="code-box"><pre class="program clipboardable"><code class="language-py"># Plot experiment data and best fit curve on the same axes
plt.plot(Rpot, Vout, 'o', label='Data');
plt.plot(Rpot_fit, Vout_fit, label='Fit')
plt.xlim(0,10500);
plt.ylim(0,3.5);
plt.xlabel(r'Resistance ($\Omega$)')
plt.ylabel(r'$V_\text{out}$')
plt.legend();
plt.show();
</code></pre></div>
<div class="autopermalink" data-description="Paragraph"><a href="#sec-labpython-curvefit-5-8" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">ðŸ”—</a></div>
</div>
<div class="autopermalink" data-description="Paragraphs: Breakdown of curve fitting routine"><a href="#sec-labpython-curvefit-5" title="Copy heading and permalink for Paragraphs: Breakdown of curve fitting routine" aria-label="Copy heading and permalink for Paragraphs: Breakdown of curve fitting routine">ðŸ”—</a></div></section><div class="autopermalink" data-description="Section 13.3: Fitting a Curve to Data"><a href="#sec-labpython-curvefit" title="Copy heading and permalink for Section 13.3: Fitting a Curve to Data" aria-label="Copy heading and permalink for Section 13.3: Fitting a Curve to Data">ðŸ”—</a></div></section></div>
<div id="ptx-content-footer" class="ptx-content-footer">
<a class="previous-button button" href="sec-labpython-plotting.html" title="Previous"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5cb;</span><span class="name">Prev</span></a><a class="top-button button" href="#" title="Top"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5ce;</span><span class="name">Top</span></a><a class="next-button button" href="sec-labpython-montecarlo.html" title="Next"><span class="name">Next</span><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5cc;</span></a>
</div></main>
</div>
<div id="ptx-page-footer" class="ptx-page-footer">
<a class="pretext-link" href="https://pretextbook.org" title="PreTeXt"><div class="logo"><svg xmlns="http://www.w3.org/2000/svg" height="100%" viewBox="338 3000 8772 6866" role="img"><title>PreTeXt logo</title><g style="stroke-width:.025in; stroke:currentColor; fill:none"><polyline points="472,3590 472,9732 " style="stroke-width:174; stroke-linejoin:miter; stroke-linecap:round; "></polyline><path style="stroke-width:126;stroke-linecap:butt;" d="M 4724,9448 A 4660 4660  0  0  1  8598  9259"></path><path style="stroke-width:174;stroke-linecap:butt;" d="M 4488,9685 A 4228 4228  0  0  0   472  9732"></path><path style="stroke-width:126;stroke-linecap:butt;" d="M 4724,3590 A 4241 4241  0  0  1  8598  3496"></path><path style="stroke-width:126;stroke-linecap:round;" d="M 850,3496  A 4241 4241  0  0  1  4724  3590"></path><path style="stroke-width:126;stroke-linecap:round;" d="M 850,9259  A 4507 4507  0  0  1  4724  9448"></path><polyline points="5385,4299 4062,8125" style="stroke-width:300; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="8598,3496 8598,9259" style="stroke-width:126; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="850,3496 850,9259" style="stroke-width:126; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="4960,9685 4488,9685" style="stroke-width:174; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="3070,4582 1889,6141 3070,7700" style="stroke-width:300; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="6418,4582 7600,6141 6418,7700" style="stroke-width:300; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="8976,3590 8976,9732" style="stroke-width:174; stroke-linejoin:miter; stroke-linecap:round;"></polyline><path style="stroke-width:174;stroke-linecap:butt;" d="M 4960,9685 A 4228 4228  0  0  1  8976  9732"></path></g></svg></div></a><a class="runestone-link" href="https://runestone.academy" title="Runestone Academy"><img class="logo" src="https://runestone.academy/runestone/static/images/RAIcon_cropped.png" alt="Runstone Academy logo"></a><a class="mathjax-link" href="https://www.mathjax.org" title="MathJax"><img class="logo" src="https://www.mathjax.org/badge/badge-square-2.png" alt="MathJax logo"></a>
</div>
</body>
</html>
